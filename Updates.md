# アップデート

1.  DBのアップグレードを考慮する

    DB構造を変更する場合、過去のCREATE TABLEで作られたテーブルを考慮した
    ALTER TABLE文を`SQLiteOpenHelper#onUpgrade()`に記述する。  
    その場合、`onUpgrade()`が適用されるようにバージョン番号を
    インクリメントすることにも注意する。

1.  SharedPreferencesのアップグレードを考慮する

    `SharedPreferences`は内部的にはXMLファイルであり、DBを扱うのと大して変わらない。
    バージョンアップ前後で同じキーの変数の型を変えたりすると、
    クラッシュしてアンインストールするしかなくなってしまうことに注意する。
    また、`SharedPreferences`にはDBのようなアップグレード用メソッドは
    用意されていないので必要に応じてバージョン番号を保存するなどの
    対策をとること。

1.  外部サービスの仕様変更を考慮する

    外部サービスやアプリと連携する場合、(当然ながら)それらが予告なく
    仕様変更することがあり得る。  
    予期しないレスポンスを受けてもアプリがクラッシュしないように
    ハンドリング処理を記述しておく。

1.  バージョンの埋め込みとハンドリング

    外部と送受信するデータについて、可能であればそのデータ仕様のバージョンを含める。
    将来的に互換性のないデータ構造変更をせざるを得なくなった場合、
    バージョン番号を使ってアプリ内の処理を切り替えたりしやすくなる。
